//######
//## TreeWidget_v0.cpp
//## =================
//## 28.02.2013: Creation d'apres codeprogress
//##             http://www.codeprogress.com/cpp/libraries/qt/qtreewidgetbrowsedirectory.php#.US8PK-uCSik
//## 08.04.2018: Derni√®re mise en page pour le site 
//######

#include "TreeWidget_v0.h"

//
// <<<< myTreeWidget::myTreeWidget
//
myTreeWidget::myTreeWidget( QWidget * p_Parent ):
    QTreeWidget( p_Parent )
{
  //-- Add Subdirectories as children  when user clicks on a file item,
  //-- otherwise adding all children recursively may consume HUGE amount of memory

  connect( this , SIGNAL( itemClicked  ( QTreeWidgetItem *, int) )
         , this , SLOT  ( slot_showDirectory( QTreeWidgetItem *, int) ) );
}
// >>>> myTreeWidget::myTreeWidget
 
  
//
// <<<< myTreeWidget::~myTreeWidget
//
myTreeWidget::~myTreeWidget()
{
}
// >>>> myTreeWidget::~myTreeWidget

  
//
// <<<< myTreeWidget::slot_showDirectory
//
void myTreeWidget::slot_showDirectory( QTreeWidgetItem * p_Item, int /*p_Column*/ )
{
  QDir * rootDir = new QDir( p_Item->text( 2 ) );
  QFileInfoList filesList = rootDir->entryInfoList();	  
	
  foreach( QFileInfo fileInfo, filesList ) {
    QTreeWidgetItem * child = new QTreeWidgetItem();
    child->setText( 0, fileInfo.fileName() );	  
    
    if ( fileInfo.isFile() ) {  
      child->setText( 1, QString::number( fileInfo.size() ) );
      child->setIcon( 0, *( new QIcon( "file.jpg" ) ) );
    }
	    
    if ( fileInfo.isDir() ) {
      child->setIcon( 0, *( new QIcon( "folder.jpg" ) ) );
      child->setText( 2, fileInfo.filePath() );
    } 
	    
    p_Item->addChild( child );
	    
    resizeColumnToContents( 0 );
  }
}
// >>>> myTreeWidget::slot_showDirectory
